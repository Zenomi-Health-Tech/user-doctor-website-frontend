import{r as i,j as e,b as p,c as N}from"./index-m2i5zgkR.js";import{D as k}from"./style-BAMwFuWl.js";function E(){var f,u;const[m,j]=i.useState([]),[n,v]=i.useState(()=>{const t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())}),[o,w]=i.useState(null),[x]=i.useState(!1),[h]=i.useState([]),d=n.toISOString().split("T")[0];i.useEffect(()=>{(async()=>{const l=p.get("auth");let a="";if(l)try{a=JSON.parse(l).token}catch{}const r=await N.get("/users/get-user-available-slots",{headers:{Authorization:`Bearer ${a}`}});console.log(r),j(r.data.data||[])})()},[]);const y=async()=>{if(!o)return;const t=m[0],l=t.availabilities.find(c=>c.date.split("T")[0]===d);if(!l)return;const a=l.timeSlots.find(c=>c.id===o);if(!a)return;const r=d,C=a.startTime.slice(11,16),g=p.get("auth");let b="";if(g)try{b=JSON.parse(g).token}catch{}await N.post("/users/book-appointment",{doctorId:t.doctorId,preferredDate:r,preferredTimeSlot:C},{headers:{Authorization:`Bearer ${b}`}})},s=m[0],S=((f=s==null?void 0:s.doctorName)==null?void 0:f.split(" ").map(t=>t[0]).join("").toUpperCase())||"",D=((u=s==null?void 0:s.specialization)==null?void 0:u.length)>22?s.specialization.slice(0,20)+"..":(s==null?void 0:s.specialization)||"";return e.jsx("div",{className:"w-full p-0 m-0 font-['Poppins'] min-h-[600px]",children:e.jsxs("div",{className:"p-8 w-full",children:[s?e.jsxs("div",{className:"flex items-center bg-white rounded-2xl border border-[#E5E5E5] p-4 mb-8 shadow-sm max-w-md",children:[s.photoUrl?e.jsx("img",{src:s.photoUrl,alt:s.doctorName,className:"w-14 h-14 rounded-xl object-cover bg-[#F8F2F9] mr-4"}):e.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center bg-[#F8F2F9] text-[#8B2D6C] text-xl font-bold mr-4",children:S}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-lg text-black",children:["Dr.",s.doctorName]}),e.jsxs("div",{className:"text-sm text-gray-700",children:["Specialist in ",D]})]})]}):e.jsx("div",{className:"w-full flex justify-center py-8",children:e.jsxs("div",{className:"flex items-center bg-white rounded-2xl border border-[#E5E5E5] p-4 mb-8 shadow-sm max-w-md w-full",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center bg-[#F8F2F9] text-[#8B2D6C] text-xl font-bold mr-4",children:"--"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-lg text-black",children:"No Doctor Available"}),e.jsx("div",{className:"text-sm text-gray-700",children:"No specialization info"})]})]})}),e.jsx("div",{className:"flex flex-col items-center w-full",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-md w-full max-w-2xl flex flex-col items-center mx-auto",children:[e.jsxs("div",{className:"mb-6 w-full flex flex-col items-center",children:[e.jsx("div",{className:"text-lg font-semibold mb-2",children:n.toLocaleString("default",{month:"long",year:"numeric"})}),e.jsx(k,{mode:"single",selected:n,onSelect:t=>{if(t){const l=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()));v(l)}},className:"rounded-xl shadow-sm border",styles:{caption:{color:"#1A2343",fontWeight:600},day_selected:{background:"linear-gradient(90deg, #8B2D6C 0%, #C6426E 100%)",color:"white"},day:{borderRadius:"9999px",fontWeight:500}}})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Slots Available"}),s&&s.availabilities?(()=>{const t=s.availabilities.find(l=>l.date.split("T")[0]===d);return!t||!t.timeSlots.length?e.jsx("div",{className:"text-gray-500 mb-4",children:"No slots available for this date."}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 mb-8",children:t.timeSlots.map(l=>{const a=l.startTime.slice(11,16);return e.jsx("button",{className:`py-2 rounded-full border w-full ${o===l.id?"bg-gradient-to-r from-[#8B2D6C] to-[#C6426E] text-white border-none":"bg-white text-gray-700 border-gray-300"}`,onClick:()=>w(l.id===o?null:l.id),type:"button",children:a},l.id)})})})():e.jsx("div",{className:"text-gray-500 mb-4",children:"No slots available for this date."}),e.jsx("button",{className:"w-full py-3 rounded-full bg-gradient-to-r from-[#8B2D6C] to-[#C6426E] text-white font-semibold text-lg shadow hover:opacity-90 transition",onClick:y,disabled:x||!o,children:x?"Booking...":"Book Appointment"})]})]})}),e.jsx("div",{className:"w-full mt-8",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow flex flex-col gap-6",children:[e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"All Available Slots"}),h.length===0?e.jsx("p",{className:"text-gray-500",children:"No slots found."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(t=>e.jsxs("div",{className:"border rounded-xl p-4 bg-[#FAF8FB]",children:[e.jsx("div",{className:"font-semibold text-[#8B2D6C] mb-2",children:new Date(t.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:(t.slots||[]).map((l,a)=>e.jsx("span",{className:"inline-block px-3 py-1 rounded-full bg-[#8B2D6C1A] text-[#8B2D6C] text-sm",children:l},a))})]},t.date))})]})})]})})}export{E as default};
