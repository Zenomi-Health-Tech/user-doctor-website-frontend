import{a as h}from"./api-CfFxSABt.js";import{R as N,f as A,h as b,s as C}from"./index-CYNiLy_Y.js";const E=e=>{let r;const t=new Set,o=(y,a)=>{const p=typeof y=="function"?y(r):y;if(!Object.is(p,r)){const v=r;r=a??(typeof p!="object"||p===null)?p:Object.assign({},r,p),t.forEach(f=>f(r,v))}},n=()=>r,s={setState:o,getState:n,getInitialState:()=>g,subscribe:y=>(t.add(y),()=>t.delete(y))},g=r=e(o,n,s);return s},D=e=>e?E(e):E,R=e=>e;function j(e,r=R){const t=N.useSyncExternalStore(e.subscribe,()=>r(e.getState()),()=>r(e.getInitialState()));return N.useDebugValue(t),t}const k=e=>{const r=D(e),t=o=>j(r,o);return Object.assign(t,r),t},L=e=>e?k(e):k,P={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},T=new Map,O=e=>{const r=T.get(e);return r?Object.fromEntries(Object.entries(r.stores).map(([t,o])=>[t,o.getState()])):{}},U=(e,r,t)=>{if(e===void 0)return{type:"untracked",connection:r.connect(t)};const o=T.get(t.name);if(o)return{type:"tracked",store:e,...o};const n={connection:r.connect(t),stores:{}};return T.set(t.name,n),{type:"tracked",store:e,...n}},x=(e,r={})=>(t,o,n)=>{const{enabled:i,anonymousActionType:u,store:s,...g}=r;let y;try{y=(i??(P?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!y)return e(t,o,n);const{connection:a,...p}=U(s,y,g);let v=!0;n.setState=(c,m,l)=>{const d=t(c,m);if(!v)return d;const w=l===void 0?{type:u||"anonymous"}:typeof l=="string"?{type:l}:l;return s===void 0?(a==null||a.send(w,o()),d):(a==null||a.send({...w,type:`${s}/${w.type}`},{...O(g.name),[s]:n.getState()}),d)};const f=(...c)=>{const m=v;v=!1,t(...c),v=m},I=e(n.setState,o,n);if(p.type==="untracked"?a==null||a.init(I):(p.stores[p.store]=n,a==null||a.init(Object.fromEntries(Object.entries(p.stores).map(([c,m])=>[c,c===p.store?I:m.getState()])))),n.dispatchFromDevtools&&typeof n.dispatch=="function"){let c=!1;const m=n.dispatch;n.dispatch=(...l)=>{(P?"production":void 0)!=="production"&&l[0].type==="__setState"&&!c&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),c=!0),m(...l)}}return a.subscribe(c=>{var m;switch(c.type){case"ACTION":if(typeof c.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return _(c.payload,l=>{if(l.type==="__setState"){if(s===void 0){f(l.state);return}Object.keys(l.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const d=l.state[s];if(d==null)return;JSON.stringify(n.getState())!==JSON.stringify(d)&&f(d);return}n.dispatchFromDevtools&&typeof n.dispatch=="function"&&n.dispatch(l)});case"DISPATCH":switch(c.payload.type){case"RESET":return f(I),s===void 0?a==null?void 0:a.init(n.getState()):a==null?void 0:a.init(O(g.name));case"COMMIT":if(s===void 0){a==null||a.init(n.getState());return}return a==null?void 0:a.init(O(g.name));case"ROLLBACK":return _(c.state,l=>{if(s===void 0){f(l),a==null||a.init(n.getState());return}f(l[s]),a==null||a.init(O(g.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return _(c.state,l=>{if(s===void 0){f(l);return}JSON.stringify(n.getState())!==JSON.stringify(l[s])&&f(l[s])});case"IMPORT_STATE":{const{nextLiftedState:l}=c.payload,d=(m=l.computedStates.slice(-1)[0])==null?void 0:m.state;if(!d)return;f(s===void 0?d:d[s]),a==null||a.send(null,l);return}case"PAUSE_RECORDING":return v=!v}return}}),I},J=x,_=(e,r)=>{let t;try{t=JSON.parse(e)}catch(o){console.error("[zustand devtools middleware] Could not parse the received json",o)}t!==void 0&&r(t)},S=e=>{if(e.response){const{data:r}=e.response;return r.status==="error"?r.error||r.message||"An unexpected error occurred.":r.message||"An unexpected error occurred."}return"Network error. Please try again."},M=(e,r,t,o,n,i)=>{e&&localStorage.setItem("companyName",e),r&&localStorage.setItem("email",r),t&&localStorage.setItem("logo",t)},q=()=>{localStorage.removeItem("companyName"),localStorage.removeItem("email"),localStorage.removeItem("logo"),localStorage.removeItem("businessName"),localStorage.removeItem("buisnessEmail"),localStorage.removeItem("buisnessWebsite")},B=(e,r)=>({phoneNumber:"",countryCode:"",user:A()||null,tempToken:null,error:null,loading:!1,orderId:null,setPhoneNumber:t=>e({phoneNumber:t}),setCountryCode:t=>e({countryCode:t}),sendOtp:async t=>{e({loading:!0,error:null});try{const{phoneNumber:o}=r(),n={countryCode:t,phoneNumber:o},i=await h.post("otp-service/send-otp",n),{orderId:u}=i.data.data;e({orderId:u}),console.log(i.data.data)}catch(o){throw e({error:S(o)}),o}finally{e({loading:!1})}},resendOtp:async()=>{e({loading:!0,error:null});try{const{phoneNumber:t,countryCode:o}=r(),n={countryCode:o,phoneNumber:t};await h.post("/otp-service/resend-otp-register",n)}catch(t){e({error:S(t)})}finally{e({loading:!1})}},verifyOtp:async t=>{e({loading:!0,error:null});try{const{phoneNumber:o,countryCode:n,orderId:i}=r();if(!i)throw new Error("Order ID is missing. Please request OTP again.");const u={countryCode:n,phoneNumber:o,otp:t,orderId:i},s=await h.post("/otp-service/verify-otp",u),{token:g}=s.data;return e({tempToken:g}),console.log(s.data.message),!0}catch(o){return e({error:S(o)}),b(),e({user:null}),!1}finally{e({loading:!1})}},createProfile:async t=>{e({loading:!0,error:null});try{const{tempToken:o}=r();if(!o)throw new Error("No token found. Please verify OTP first.");const n=await h.post("/profile/createProfile",t,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"multipart/form-data"}}),{businessName:i,buisnessEmail:u,logo:s}=n.data.data;return M(i,u,s),e({user:{...n.data.data,token:o},tempToken:null}),C({token:o}),!0}catch(o){return e({error:S(o)}),!1}finally{e({loading:!1})}},logout:()=>{b(),q(),e({user:null,tempToken:null,orderId:null})}}),z=(e,r)=>({countryCode:"+91",phoneNumber:"",user:A()||null,orderId:null,error:null,loading:!1,updatePhoneDetails:(t,o)=>e({countryCode:t,phoneNumber:o}),requestOtp:async()=>{e({loading:!0,error:null});try{const{countryCode:t,phoneNumber:o}=r(),n=await h.post("/doctors/login/send-otp",{countryCode:t,phoneNumber:o}),{orderId:i}=n.data.data;e({orderId:i})}catch(t){throw e({error:S(t)}),t}finally{e({loading:!1})}},userRequestOtp:async()=>{e({loading:!0,error:null});try{const{countryCode:t,phoneNumber:o}=r(),n=await h.post("/users/send-otp",{countryCode:t,phoneNumber:o}),{orderId:i}=n.data.data;e({orderId:i})}catch(t){throw e({error:S(t)}),t}finally{e({loading:!1})}},resendOtpLogin:async()=>{e({loading:!0,error:null});try{const{countryCode:t,phoneNumber:o}=r();await h.post("/auth/resendOTP",{countryCode:t,phoneNumber:o})}catch(t){e({error:S(t)})}finally{e({loading:!1})}},validateOtp:async t=>{e({loading:!0,error:null});try{const{countryCode:o,phoneNumber:n,orderId:i}=r();if(!i)throw new Error("Order ID is missing. Please request OTP again.");const u=await h.post("/doctors/login/verify-otp",{otp:t,countryCode:o,phoneNumber:n,orderId:i}),{token:s}=u.data.data;return console.log(s),C({token:s}),!0}catch(o){return e({error:S(o)}),b(),e({user:null,orderId:null}),!1}finally{e({loading:!1})}},userValidateOtp:async t=>{e({loading:!0,error:null});try{const{countryCode:o,phoneNumber:n,orderId:i}=r();if(!i)throw new Error("Order ID is missing. Please request OTP again.");const u=await h.post("/users/verify-otp",{otp:t,countryCode:o,phoneNumber:n,orderId:i}),{token:s}=u.data.data;return console.log(s),C({token:s}),!0}catch(o){return e({error:S(o)}),b(),e({user:null,orderId:null}),!1}finally{e({loading:!1})}},logout:()=>{b(),e({user:null,orderId:null,countryCode:"+91",phoneNumber:""})}}),W=L()(J((e,r,t)=>({...B(e,r),...z(e,r)}))),$="/assets/bgLogo-Ut4HqAQC.png";export{$ as B,S as h,W as u};
