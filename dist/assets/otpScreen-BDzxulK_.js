import{f as w,r as P,j as t,B as T,a as S}from"./index-m2i5zgkR.js";import{u as k,L as C,t as R,z as f,C as B}from"./index-D2wb742Z.js";import{u as a,B as E}from"./bgLogo-DExYBkLg.js";const L=f.object({otp:f.string().length(6,{message:"OTP must be exactly 6 digits"}).regex(/^\d+$/,{message:"OTP must only contain digits"})}),D=({onSuccess:o})=>{const{handleSubmit:c,setValue:x,watch:l,formState:{errors:d}}=k({resolver:R(L),defaultValues:{otp:""}}),h=a(e=>e.resendOtpLogin),y=a(e=>e.validateOtp),u=a(e=>e.error),m=a(e=>e.loading),b=a(e=>e.phoneNumber),{toast:n}=w(),i=Array(6).fill(0).map(()=>P.useRef(null)),j=async({otp:e})=>{try{const s=await y(e);if(console.log("OTP validation result:",s),s)n({title:"Success",description:"OTP verified successfully!",variant:"default",className:"bg-green-500 text-white"}),o(),window.location.reload();else{const r=u||"Invalid OTP. Please try again.";n({title:"Error",description:r,variant:"destructive"}),console.log("OTP verification failed:",{otp:e,error:r})}}catch(s){console.error("Unexpected error during OTP verification:",s),n({title:"Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}},v=async()=>{try{await h(),n({title:"Success",description:"OTP sent again successfully!",variant:"default"})}catch{console.error("Resend OTP error:",u),n({title:"Error",description:"Failed to resend OTP.",variant:"destructive"})}},N=(e,s)=>{var g;s.length>1&&(s=s[0]);const p=(l("otp")||"").split("");p[e]=s,x("otp",p.join("")),s&&e<5&&((g=i[e+1].current)==null||g.focus())},O=(e,s)=>{var r;s.key==="Backspace"&&!l("otp")[e]&&e>0&&((r=i[e-1].current)==null||r.focus())};return t.jsxs("form",{onSubmit:c(j),className:"w-full space-y-6 font-['Poppins']",children:[t.jsxs("div",{className:"text-center space-y-4",children:[t.jsx("h1",{className:"text-2xl font-semibold",children:"Verify your OTP"}),t.jsxs("p",{className:"text-gray-600",children:["Enter the 6-digit code sent to ",b]})]}),t.jsx("div",{className:"flex justify-center gap-3",children:Array(6).fill(0).map((e,s)=>t.jsx("input",{type:"text",maxLength:1,ref:i[s],onChange:r=>N(s,r.target.value),onKeyDown:r=>O(s,r),className:"w-12 h-12 text-center text-lg font-semibold border rounded-full focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent"},s))}),d.otp&&t.jsx("p",{className:"text-red-500 text-sm text-center",children:d.otp.message}),t.jsxs("div",{className:"text-center text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Didn't get it? "}),t.jsx("button",{type:"button",onClick:v,className:"text-purple-600 font-medium hover:text-purple-700",children:"Resend"})]}),t.jsx(T,{type:"submit",disabled:m,className:"w-full h-12 text-white rounded-xl transition-colors font-medium",style:{background:"linear-gradient(89.79deg, #704180 5.07%, #8B2D6C 95.83%)"},children:m?t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx(C,{className:"animate-spin h-5 w-5 mr-2"}),t.jsx("span",{children:"Verifying..."})]}):"Send OTP"})]})};function F(){const o=S(),c=()=>{o("/doctor/register")};return t.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-900 relative",style:{backgroundImage:`linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(${E})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[t.jsx("div",{className:"absolute inset-0"}),t.jsx(B,{className:"bg-white/95 backdrop-blur-sm rounded-3xl w-[439px] shadow-xl z-10 p-8",children:t.jsx("div",{className:"w-full max-w-md mx-auto flex flex-col items-center",children:t.jsx(D,{onSuccess:c})})})]})}export{F as default};
