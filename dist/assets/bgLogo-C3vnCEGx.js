import{R as N,g as R,h as b,c as O,s as C,d as S,b as P}from"./index-9IGzMayQ.js";const k=e=>{let r;const t=new Set,o=(p,s)=>{const m=typeof p=="function"?p(r):p;if(!Object.is(m,r)){const h=r;r=s??(typeof m!="object"||m===null)?m:Object.assign({},r,m),t.forEach(y=>y(r,h))}},n=()=>r,a={setState:o,getState:n,getInitialState:()=>d,subscribe:p=>(t.add(p),()=>t.delete(p))},d=r=e(o,n,a);return a},z=e=>e?k(e):k,x=e=>e;function j(e,r=x){const t=N.useSyncExternalStore(e.subscribe,()=>r(e.getState()),()=>r(e.getInitialState()));return N.useDebugValue(t),t}const A=e=>{const r=z(e),t=o=>j(r,o);return Object.assign(t,r),t},L=e=>e?A(e):A,D={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},E=new Map,w=e=>{const r=E.get(e);return r?Object.fromEntries(Object.entries(r.stores).map(([t,o])=>[t,o.getState()])):{}},U=(e,r,t)=>{if(e===void 0)return{type:"untracked",connection:r.connect(t)};const o=E.get(t.name);if(o)return{type:"tracked",store:e,...o};const n={connection:r.connect(t),stores:{}};return E.set(t.name,n),{type:"tracked",store:e,...n}},M=(e,r={})=>(t,o,n)=>{const{enabled:i,anonymousActionType:c,store:a,...d}=r;let p;try{p=(i??(D?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!p)return e(t,o,n);const{connection:s,...m}=U(a,p,d);let h=!0;n.setState=(u,g,l)=>{const f=t(u,g);if(!h)return f;const T=l===void 0?{type:c||"anonymous"}:typeof l=="string"?{type:l}:l;return a===void 0?(s==null||s.send(T,o()),f):(s==null||s.send({...T,type:`${a}/${T.type}`},{...w(d.name),[a]:n.getState()}),f)};const y=(...u)=>{const g=h;h=!1,t(...u),h=g},I=e(n.setState,o,n);if(m.type==="untracked"?s==null||s.init(I):(m.stores[m.store]=n,s==null||s.init(Object.fromEntries(Object.entries(m.stores).map(([u,g])=>[u,u===m.store?I:g.getState()])))),n.dispatchFromDevtools&&typeof n.dispatch=="function"){let u=!1;const g=n.dispatch;n.dispatch=(...l)=>{(D?"production":void 0)!=="production"&&l[0].type==="__setState"&&!u&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),u=!0),g(...l)}}return s.subscribe(u=>{var g;switch(u.type){case"ACTION":if(typeof u.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return _(u.payload,l=>{if(l.type==="__setState"){if(a===void 0){y(l.state);return}Object.keys(l.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const f=l.state[a];if(f==null)return;JSON.stringify(n.getState())!==JSON.stringify(f)&&y(f);return}n.dispatchFromDevtools&&typeof n.dispatch=="function"&&n.dispatch(l)});case"DISPATCH":switch(u.payload.type){case"RESET":return y(I),a===void 0?s==null?void 0:s.init(n.getState()):s==null?void 0:s.init(w(d.name));case"COMMIT":if(a===void 0){s==null||s.init(n.getState());return}return s==null?void 0:s.init(w(d.name));case"ROLLBACK":return _(u.state,l=>{if(a===void 0){y(l),s==null||s.init(n.getState());return}y(l[a]),s==null||s.init(w(d.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return _(u.state,l=>{if(a===void 0){y(l);return}JSON.stringify(n.getState())!==JSON.stringify(l[a])&&y(l[a])});case"IMPORT_STATE":{const{nextLiftedState:l}=u.payload,f=(g=l.computedStates.slice(-1)[0])==null?void 0:g.state;if(!f)return;y(a===void 0?f:f[a]),s==null||s.send(null,l);return}case"PAUSE_RECORDING":return h=!h}return}}),I},J=M,_=(e,r)=>{let t;try{t=JSON.parse(e)}catch(o){console.error("[zustand devtools middleware] Could not parse the received json",o)}t!==void 0&&r(t)},v=e=>{if(e.response){const{data:r}=e.response;return r.status==="error"?r.error||r.message||"An unexpected error occurred.":r.message||"An unexpected error occurred."}return"Network error. Please try again."},F=(e,r,t,o,n,i)=>{e&&localStorage.setItem("companyName",e),r&&localStorage.setItem("email",r),t&&localStorage.setItem("logo",t)},q=()=>{localStorage.removeItem("companyName"),localStorage.removeItem("email"),localStorage.removeItem("logo"),localStorage.removeItem("businessName"),localStorage.removeItem("buisnessEmail"),localStorage.removeItem("buisnessWebsite")},B=(e,r)=>({phoneNumber:"",countryCode:"",user:R()||null,tempToken:null,error:null,loading:!1,orderId:null,setPhoneNumber:t=>e({phoneNumber:t}),setCountryCode:t=>e({countryCode:t}),sendOtp:async t=>{e({loading:!0,error:null});try{const{phoneNumber:o}=r(),n={countryCode:t,phoneNumber:o},i=await O.post("otp-service/send-otp",n),{orderId:c}=i.data.data;e({orderId:c}),console.log(i.data.data)}catch(o){throw e({error:v(o)}),o}finally{e({loading:!1})}},resendOtp:async()=>{e({loading:!0,error:null});try{const{phoneNumber:t,countryCode:o}=r(),n={countryCode:o,phoneNumber:t};await O.post("/otp-service/resend-otp-register",n)}catch(t){e({error:v(t)})}finally{e({loading:!1})}},verifyOtp:async t=>{e({loading:!0,error:null});try{const{phoneNumber:o,countryCode:n,orderId:i}=r();if(!i)throw new Error("Order ID is missing. Please request OTP again.");const c={countryCode:n,phoneNumber:o,otp:t,orderId:i},a=await O.post("/otp-service/verify-otp",c),{token:d}=a.data;return e({tempToken:d}),console.log(a.data.message),!0}catch(o){return e({error:v(o)}),b(),e({user:null}),!1}finally{e({loading:!1})}},createProfile:async t=>{e({loading:!0,error:null});try{const{tempToken:o}=r();if(!o)throw new Error("No token found. Please verify OTP first.");const n=await O.post("/profile/createProfile",t,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"multipart/form-data"}}),{businessName:i,buisnessEmail:c,logo:a}=n.data.data;return F(i,c,a),e({user:{...n.data.data,token:o},tempToken:null}),C({token:o}),!0}catch(o){return e({error:v(o)}),!1}finally{e({loading:!1})}},logout:()=>{b(),q(),e({user:null,tempToken:null,orderId:null})}}),V=(e,r)=>({countryCode:"+91",phoneNumber:"",orderId:null,error:null,loading:!1,updatePhoneDetails:(t,o)=>e({countryCode:t,phoneNumber:o}),requestOtp:async()=>{e({loading:!0,error:null});try{const{countryCode:t,phoneNumber:o}=r(),n=await S.post("https://apizenomiotp.zenomihealth.com/api/v1/doctors/login/send-otp",{countryCode:t,phoneNumber:o}),{orderId:i}=n.data.data;e({orderId:i})}catch(t){throw e({error:v(t)}),t}finally{e({loading:!1})}},userRequestOtp:async()=>{e({loading:!0,error:null});try{const{countryCode:t,phoneNumber:o}=r(),n=await S.post("https://apizenomiotp.zenomihealth.com/api/v1/users/send-otp",{countryCode:t,phoneNumber:o}),{orderId:i}=n.data.data;e({orderId:i})}catch(t){throw e({error:v(t)}),t}finally{e({loading:!1})}},resendOtpLogin:async()=>{e({loading:!0,error:null});try{const{countryCode:t,phoneNumber:o}=r();await S.post("https://apizenomiotp.zenomihealth.com/api/v1/auth/resendOTP",{countryCode:t,phoneNumber:o})}catch(t){e({error:v(t)})}finally{e({loading:!1})}},validateOtp:async t=>{var o,n;e({loading:!0,error:null});try{const{countryCode:i,phoneNumber:c,orderId:a}=r();if(!a)throw new Error("Order ID is missing. Please request OTP again.");console.log("Validating OTP with:",{orderId:a,countryCode:i,phoneNumber:c,otp:t});const d=await S.post("https://apizenomiotp.zenomihealth.com/api/v1/doctors/login/verify-otp",{otp:t,countryCode:i,phoneNumber:c,orderId:a});if(!d.data||!d.data.data)throw new Error("Invalid response from server");const{token:p}=d.data.data,{id:s}=d.data.data.doctor;return P.set("userId",s,{expires:7}),C({token:p}),e({error:null}),!0}catch(i){const c=((n=(o=i.response)==null?void 0:o.data)==null?void 0:n.message)||i.message||"Failed to verify OTP";return console.error("OTP validation error:",c),e({error:c}),b(),!1}finally{e({loading:!1})}},userValidateOtp:async t=>{var o,n;e({loading:!0,error:null});try{const{countryCode:i,phoneNumber:c,orderId:a}=r();if(!a)throw new Error("Order ID is missing. Please request OTP again.");const d=await S.post("https://apizenomiotp.zenomihealth.com/api/v1/users/verify-otp",{otp:t,countryCode:i,phoneNumber:c,orderId:a});if(!d.data||!d.data.data)throw new Error("Invalid response from server");const{token:p}=d.data.data,{id:s}=d.data.data.user;return P.set("userId",s,{expires:7}),C({token:p}),e({error:null}),!0}catch(i){const c=((n=(o=i.response)==null?void 0:o.data)==null?void 0:n.message)||i.message||"Failed to verify OTP";return console.error("OTP validation error:",c),e({error:c}),b(),!1}finally{e({loading:!1})}},logout:()=>{b(),e({orderId:null,countryCode:"+91",phoneNumber:""})}}),W=L()(J((e,r,t)=>({...B(e,r),...V(e,r)}))),G="/assets/bgLogo-Ut4HqAQC.png";export{G as B,v as h,W as u};
