import{u as w,r as P,j as t,B as T,e as S,L as k}from"./index-CWxa_91Z.js";import{u as L,L as C,t as R,z as f}from"./index-A7bHfbOT.js";import{u as n}from"./store-SP_n7ALW.js";import{C as V}from"./card-D8ZZsheq.js";import{B}from"./BackgroundImage-BCOy0lxJ.js";import"./api-DM17oJ_R.js";const E=f.object({otp:f.string().length(6,{message:"OTP must be exactly 6 digits"}).regex(/^\d+$/,{message:"OTP must only contain digits"})}),z=({onSuccess:a})=>{const{handleSubmit:c,setValue:x,watch:l,formState:{errors:u}}=L({resolver:R(E),defaultValues:{otp:""}}),h=n(e=>e.resendOtpLogin),y=n(e=>e.userValidateOtp),d=n(e=>e.error),m=n(e=>e.loading),b=n(e=>e.phoneNumber),{toast:o}=w(),i=Array(6).fill(0).map(()=>P.useRef(null)),j=async({otp:e})=>{const s=await y(e);s?(o({title:"Success",description:"OTP verified successfully!",variant:"default",className:"bg-green-500 text-white"}),a(),console.log(s)):(console.error("Verification error:",d),o({title:"Error",description:"Invalid OTP. Please try again.",variant:"destructive"}),console.log("Entered wrong OTP:",e))},N=async()=>{try{await h(),o({title:"Success",description:"OTP sent again successfully!",variant:"default"})}catch{console.error("Resend OTP error:",d),o({title:"Error",description:"Failed to resend OTP.",variant:"destructive"})}},v=(e,s)=>{var g;s.length>1&&(s=s[0]);const p=(l("otp")||"").split("");p[e]=s,x("otp",p.join("")),s&&e<5&&((g=i[e+1].current)==null||g.focus())},O=(e,s)=>{var r;s.key==="Backspace"&&!l("otp")[e]&&e>0&&((r=i[e-1].current)==null||r.focus())};return t.jsxs("form",{onSubmit:c(j),className:"w-full space-y-6 font-['Poppins']",children:[t.jsxs("div",{className:"text-center space-y-4",children:[t.jsx("h1",{className:"text-2xl font-semibold",children:"Verify your OTP"}),t.jsxs("p",{className:"text-gray-600",children:["Enter the 6-digit code sent to ",b]})]}),t.jsx("div",{className:"flex justify-center gap-3",children:Array(6).fill(0).map((e,s)=>t.jsx("input",{type:"text",maxLength:1,ref:i[s],onChange:r=>v(s,r.target.value),onKeyDown:r=>O(s,r),className:"w-12 h-12 text-center text-lg font-semibold border rounded-full focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent"},s))}),u.otp&&t.jsx("p",{className:"text-red-500 text-sm text-center",children:u.otp.message}),t.jsxs("div",{className:"text-center text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Didn't get it? "}),t.jsx("button",{type:"button",onClick:N,className:"text-purple-600 font-medium hover:text-purple-700",children:"Resend"})]}),t.jsx(T,{type:"submit",disabled:m,className:"w-full h-12 text-white rounded-xl transition-colors font-medium",style:{background:"linear-gradient(89.79deg, #704180 5.07%, #8B2D6C 95.83%)"},children:m?t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx(C,{className:"animate-spin h-5 w-5 mr-2"}),t.jsx("span",{children:"Verifying..."})]}):"Send OTP"})]})};function G(){const a=S(),c=()=>{a("/user/register")};return t.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-900 relative",style:{backgroundImage:`url(${B})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-600/90 via-purple-500/90 to-purple-800/90"}),t.jsx(V,{className:"bg-white/95 backdrop-blur-sm rounded-3xl w-[539px] shadow-xl z-10 p-8",children:t.jsxs("div",{className:"w-96 mt-10 mx-auto flex flex-col items-center",children:[t.jsx("img",{src:k,alt:"Logo",loading:"lazy"}),t.jsx(z,{onSuccess:c})]})})]})}export{G as default};
