import{r as u,a as D,f as j,j as t,b,c as S}from"./index-CDFcfING.js";import{D as A}from"./style-BWI0mQoV.js";const P={Morning:["10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM"],Afternoon:["12:30 PM","01:00 PM","01:30 PM","02:00 PM","02:30 PM"],Evening:["03:00 PM","03:30 PM","04:00 PM","04:30 PM","05:00 PM"],Night:["05:30 PM","06:00 PM","06:30 PM","07:00 PM","07:30 PM"]},C=["Morning","Afternoon","Evening","Night"];function M(a){const o=c=>c.toString().padStart(2,"0");return a.getFullYear()+"-"+o(a.getMonth()+1)+"-"+o(a.getDate())+"T"+o(a.getHours())+":"+o(a.getMinutes())+":00"}function T(a,o){const[c,d]=o.split(" ");let[i,n]=c.split(":").map(Number);d==="PM"&&i!==12&&(i+=12),d==="AM"&&i===12&&(i=0);const m=new Date(a);return m.setHours(i,n,0,0),M(m)}function k(a,o,c){const[d,i]=o.split(" ");let[n,m]=d.split(":").map(Number);i==="PM"&&n!==12&&(n+=12),i==="AM"&&n===12&&(n=0);const g=new Date(a);return g.setHours(n,m+c,0,0),M(g)}function F(){const[a,o]=u.useState(()=>{const e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate())}),[c,d]=u.useState([]),[i,n]=u.useState(!1),[m,g]=u.useState("Morning"),w=D(),{toast:f}=j(),[p,N]=u.useState([]);u.useEffect(()=>{(async()=>{const s=b.get("auth");let r="";if(s)try{r=JSON.parse(s).token}catch{r=""}const h=((await S.get("/doctors/availability/all-slots",{headers:{Authorization:`Bearer ${r}`}})).data.data||[]).map(l=>({date:l.availability,timeSlots:l.doctorAvailabilityTimeSlot||[]}));N(h)})()},[]);const v=e=>{d(s=>s.includes(e)?s.filter(r=>r!==e):[...s,e])},y=async()=>{n(!0);const e=b.get("auth");let s="";if(e)try{s=JSON.parse(e).token}catch{s=""}const r=c.map(l=>({startTime:T(a,l),endTime:k(a,l,30)})),x=l=>l.toString().padStart(2,"0"),h=`${a.getFullYear()}-${x(a.getMonth()+1)}-${x(a.getDate())}`;try{const l=await S.post("/doctors/availability",{date:h,timeSlots:r},{headers:{Authorization:`Bearer ${s}`}});l.data&&l.data.success&&(f({title:"Success",description:"Slot selected Successfully!",variant:"default",className:"bg-green-500 text-white"}),d([]),w(-1))}catch{f({title:"Error",description:"Failed to set availability.",variant:"default",className:"bg-red-500 text-white"})}finally{n(!1)}};return t.jsx("div",{className:"w-full  p-0 m-0 font-['Poppins'] min-h-[600px]",children:t.jsxs("div",{className:"p-8 w-full",children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-semibold mb-8 text-gray-800",children:"Set Availability"}),t.jsx("div",{className:"flex flex-col items-center w-full",children:t.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-md w-full max-w-2xl flex flex-col items-center mx-auto",children:[t.jsxs("div",{className:"mb-6 w-full flex flex-col items-center",children:[t.jsx("div",{className:"text-lg font-semibold mb-2",children:a.toLocaleString("default",{month:"long",year:"numeric"})}),t.jsx(A,{mode:"single",selected:a,onSelect:e=>{if(e){const s=new Date(e.getFullYear(),e.getMonth(),e.getDate());o(s)}},className:"rounded-xl shadow-sm border",styles:{caption:{color:"#1A2343",fontWeight:600},day_selected:{background:"linear-gradient(90deg, #8B2D6C 0%, #C6426E 100%)",color:"white"},day:{borderRadius:"9999px",fontWeight:500}}})]}),t.jsxs("div",{className:"w-full",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Slots Available"}),t.jsx("div",{className:"flex border-b mb-4",children:C.map(e=>t.jsx("button",{className:`px-4 py-2 text-base font-medium focus:outline-none transition border-b-2 ${m===e?"border-[#8B2D6C] text-[#8B2D6C]":"border-transparent text-gray-500"}`,onClick:()=>g(e),type:"button",children:e},e))}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 mb-8",children:P[m].map(e=>t.jsx("button",{className:`py-2 rounded-full border w-full ${c.includes(e)?"bg-gradient-to-r from-[#8B2D6C] to-[#C6426E] text-white border-none":"bg-white text-gray-700 border-gray-300"}`,onClick:()=>v(e),type:"button",children:e},e))}),t.jsx("button",{className:"w-full py-3 rounded-full bg-gradient-to-r from-[#8B2D6C] to-[#C6426E] text-white font-semibold text-lg shadow hover:opacity-90 transition",onClick:y,disabled:i,children:i?"Setting...":"Set Availability"})]})]})}),t.jsx("div",{className:"w-full mt-8",children:t.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow flex flex-col gap-6",children:[t.jsx("h3",{className:"text-2xl font-bold mb-2",children:"All Available Slots"}),p.length===0?t.jsx("p",{className:"text-gray-500",children:"No slots found."}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(e=>t.jsxs("div",{className:"border rounded-xl p-4 bg-[#FAF8FB]",children:[t.jsx("div",{className:"font-semibold text-[#8B2D6C] mb-2",children:new Date(e.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:(e.timeSlots||[]).map((s,r)=>t.jsxs("span",{className:"inline-block px-3 py-1 rounded-full bg-[#8B2D6C1A] text-[#8B2D6C] text-sm",children:[new Date(s.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",new Date(s.endTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]},r))})]},e.date))})]})})]})})}export{F as default};
