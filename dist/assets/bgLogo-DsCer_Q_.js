import{R as E,g as D,h as b,c as v,s as _,b as N}from"./index-CzhxqMU8.js";const P=e=>{let o;const t=new Set,r=(p,a)=>{const y=typeof p=="function"?p(o):p;if(!Object.is(y,o)){const h=o;o=a??(typeof y!="object"||y===null)?y:Object.assign({},o,y),t.forEach(m=>m(o,h))}},n=()=>o,s={setState:r,getState:n,getInitialState:()=>d,subscribe:p=>(t.add(p),()=>t.delete(p))},d=o=e(r,n,s);return s},R=e=>e?P(e):P,j=e=>e;function x(e,o=j){const t=E.useSyncExternalStore(e.subscribe,()=>o(e.getState()),()=>o(e.getInitialState()));return E.useDebugValue(t),t}const k=e=>{const o=R(e),t=r=>x(o,r);return Object.assign(t,o),t},L=e=>e?k(e):k,A={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},C=new Map,O=e=>{const o=C.get(e);return o?Object.fromEntries(Object.entries(o.stores).map(([t,r])=>[t,r.getState()])):{}},U=(e,o,t)=>{if(e===void 0)return{type:"untracked",connection:o.connect(t)};const r=C.get(t.name);if(r)return{type:"tracked",store:e,...r};const n={connection:o.connect(t),stores:{}};return C.set(t.name,n),{type:"tracked",store:e,...n}},M=(e,o={})=>(t,r,n)=>{const{enabled:i,anonymousActionType:c,store:s,...d}=o;let p;try{p=(i??(A?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!p)return e(t,r,n);const{connection:a,...y}=U(s,p,d);let h=!0;n.setState=(u,g,l)=>{const f=t(u,g);if(!h)return f;const w=l===void 0?{type:c||"anonymous"}:typeof l=="string"?{type:l}:l;return s===void 0?(a==null||a.send(w,r()),f):(a==null||a.send({...w,type:`${s}/${w.type}`},{...O(d.name),[s]:n.getState()}),f)};const m=(...u)=>{const g=h;h=!1,t(...u),h=g},I=e(n.setState,r,n);if(y.type==="untracked"?a==null||a.init(I):(y.stores[y.store]=n,a==null||a.init(Object.fromEntries(Object.entries(y.stores).map(([u,g])=>[u,u===y.store?I:g.getState()])))),n.dispatchFromDevtools&&typeof n.dispatch=="function"){let u=!1;const g=n.dispatch;n.dispatch=(...l)=>{(A?"production":void 0)!=="production"&&l[0].type==="__setState"&&!u&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),u=!0),g(...l)}}return a.subscribe(u=>{var g;switch(u.type){case"ACTION":if(typeof u.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return T(u.payload,l=>{if(l.type==="__setState"){if(s===void 0){m(l.state);return}Object.keys(l.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const f=l.state[s];if(f==null)return;JSON.stringify(n.getState())!==JSON.stringify(f)&&m(f);return}n.dispatchFromDevtools&&typeof n.dispatch=="function"&&n.dispatch(l)});case"DISPATCH":switch(u.payload.type){case"RESET":return m(I),s===void 0?a==null?void 0:a.init(n.getState()):a==null?void 0:a.init(O(d.name));case"COMMIT":if(s===void 0){a==null||a.init(n.getState());return}return a==null?void 0:a.init(O(d.name));case"ROLLBACK":return T(u.state,l=>{if(s===void 0){m(l),a==null||a.init(n.getState());return}m(l[s]),a==null||a.init(O(d.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return T(u.state,l=>{if(s===void 0){m(l);return}JSON.stringify(n.getState())!==JSON.stringify(l[s])&&m(l[s])});case"IMPORT_STATE":{const{nextLiftedState:l}=u.payload,f=(g=l.computedStates.slice(-1)[0])==null?void 0:g.state;if(!f)return;m(s===void 0?f:f[s]),a==null||a.send(null,l);return}case"PAUSE_RECORDING":return h=!h}return}}),I},J=M,T=(e,o)=>{let t;try{t=JSON.parse(e)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}t!==void 0&&o(t)},S=e=>{if(e.response){const{data:o}=e.response;return o.status==="error"?o.error||o.message||"An unexpected error occurred.":o.message||"An unexpected error occurred."}return"Network error. Please try again."},F=(e,o,t,r,n,i)=>{e&&localStorage.setItem("companyName",e),o&&localStorage.setItem("email",o),t&&localStorage.setItem("logo",t)},q=()=>{localStorage.removeItem("companyName"),localStorage.removeItem("email"),localStorage.removeItem("logo"),localStorage.removeItem("businessName"),localStorage.removeItem("buisnessEmail"),localStorage.removeItem("buisnessWebsite")},B=(e,o)=>({phoneNumber:"",countryCode:"",user:D()||null,tempToken:null,error:null,loading:!1,orderId:null,setPhoneNumber:t=>e({phoneNumber:t}),setCountryCode:t=>e({countryCode:t}),sendOtp:async t=>{e({loading:!0,error:null});try{const{phoneNumber:r}=o(),n={countryCode:t,phoneNumber:r},i=await v.post("otp-service/send-otp",n),{orderId:c}=i.data.data;e({orderId:c}),console.log(i.data.data)}catch(r){throw e({error:S(r)}),r}finally{e({loading:!1})}},resendOtp:async()=>{e({loading:!0,error:null});try{const{phoneNumber:t,countryCode:r}=o(),n={countryCode:r,phoneNumber:t};await v.post("/otp-service/resend-otp-register",n)}catch(t){e({error:S(t)})}finally{e({loading:!1})}},verifyOtp:async t=>{e({loading:!0,error:null});try{const{phoneNumber:r,countryCode:n,orderId:i}=o();if(!i)throw new Error("Order ID is missing. Please request OTP again.");const c={countryCode:n,phoneNumber:r,otp:t,orderId:i},s=await v.post("/otp-service/verify-otp",c),{token:d}=s.data;return e({tempToken:d}),console.log(s.data.message),!0}catch(r){return e({error:S(r)}),b(),e({user:null}),!1}finally{e({loading:!1})}},createProfile:async t=>{e({loading:!0,error:null});try{const{tempToken:r}=o();if(!r)throw new Error("No token found. Please verify OTP first.");const n=await v.post("/profile/createProfile",t,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"multipart/form-data"}}),{businessName:i,buisnessEmail:c,logo:s}=n.data.data;return F(i,c,s),e({user:{...n.data.data,token:r},tempToken:null}),_({token:r}),!0}catch(r){return e({error:S(r)}),!1}finally{e({loading:!1})}},logout:()=>{b(),q(),e({user:null,tempToken:null,orderId:null})}}),z=(e,o)=>({countryCode:"+91",phoneNumber:"",orderId:null,error:null,loading:!1,updatePhoneDetails:(t,r)=>e({countryCode:t,phoneNumber:r}),requestOtp:async()=>{e({loading:!0,error:null});try{const{countryCode:t,phoneNumber:r}=o(),n=await v.post("/doctors/login/send-otp",{countryCode:t,phoneNumber:r}),{orderId:i}=n.data.data;e({orderId:i})}catch(t){throw e({error:S(t)}),t}finally{e({loading:!1})}},userRequestOtp:async()=>{e({loading:!0,error:null});try{const{countryCode:t,phoneNumber:r}=o(),n=await v.post("/users/send-otp",{countryCode:t,phoneNumber:r}),{orderId:i}=n.data.data;e({orderId:i})}catch(t){throw e({error:S(t)}),t}finally{e({loading:!1})}},resendOtpLogin:async()=>{e({loading:!0,error:null});try{const{countryCode:t,phoneNumber:r}=o();await v.post("/auth/resendOTP",{countryCode:t,phoneNumber:r})}catch(t){e({error:S(t)})}finally{e({loading:!1})}},validateOtp:async t=>{var r,n;e({loading:!0,error:null});try{const{countryCode:i,phoneNumber:c,orderId:s}=o();if(!s)throw new Error("Order ID is missing. Please request OTP again.");console.log("Validating OTP with:",{orderId:s,countryCode:i,phoneNumber:c,otp:t});const d=await v.post("/doctors/login/verify-otp",{otp:t,countryCode:i,phoneNumber:c,orderId:s});if(!d.data||!d.data.data)throw new Error("Invalid response from server");const{token:p}=d.data.data,{id:a}=d.data.data.doctor;return N.set("userId",a,{expires:7}),_({token:p}),e({error:null}),!0}catch(i){const c=((n=(r=i.response)==null?void 0:r.data)==null?void 0:n.message)||i.message||"Failed to verify OTP";return console.error("OTP validation error:",c),e({error:c}),b(),!1}finally{e({loading:!1})}},userValidateOtp:async t=>{var r,n;e({loading:!0,error:null});try{const{countryCode:i,phoneNumber:c,orderId:s}=o();if(!s)throw new Error("Order ID is missing. Please request OTP again.");const d=await v.post("/users/verify-otp",{otp:t,countryCode:i,phoneNumber:c,orderId:s});if(!d.data||!d.data.data)throw new Error("Invalid response from server");const{token:p}=d.data.data,{id:a}=d.data.data.user;return N.set("userId",a,{expires:7}),_({token:p}),e({error:null}),!0}catch(i){const c=((n=(r=i.response)==null?void 0:r.data)==null?void 0:n.message)||i.message||"Failed to verify OTP";return console.error("OTP validation error:",c),e({error:c}),b(),!1}finally{e({loading:!1})}},logout:()=>{b(),e({orderId:null,countryCode:"+91",phoneNumber:""})}}),$=L()(J((e,o,t)=>({...B(e,o),...z(e,o)}))),W="/assets/bgLogo-Ut4HqAQC.png";export{W as B,S as h,$ as u};
