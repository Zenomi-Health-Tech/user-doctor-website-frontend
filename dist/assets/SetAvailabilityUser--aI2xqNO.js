import{r as i,j as e,b as g,c as p}from"./index-CzhxqMU8.js";import{D}from"./style-Cw6RCwoD.js";function B(){const[n,b]=i.useState([]),[c,N]=i.useState(()=>{const t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())}),[r,j]=i.useState(null),[x]=i.useState(!1),[h]=i.useState([]),d=c.toISOString().split("T")[0];i.useEffect(()=>{(async()=>{const l=g.get("auth");let s="";if(l)try{s=JSON.parse(l).token}catch{}const o=await p.get("/users/get-user-available-slots",{headers:{Authorization:`Bearer ${s}`}});console.log(o),b(o.data.data||[])})()},[]);const v=async()=>{if(!r)return;const t=n[0],l=t.availabilities.find(m=>m.date.split("T")[0]===d);if(!l)return;const s=l.timeSlots.find(m=>m.id===r);if(!s)return;const o=d,y=s.startTime.slice(11,16),u=g.get("auth");let f="";if(u)try{f=JSON.parse(u).token}catch{}await p.post("/users/book-appointment",{doctorId:t.doctorId,preferredDate:o,preferredTimeSlot:y},{headers:{Authorization:`Bearer ${f}`}})};if(!n.length)return e.jsx("div",{className:"p-8",children:"Loading doctor info..."});const a=n[0],w=a.doctorName.split(" ").map(t=>t[0]).join("").toUpperCase(),S=a.specialization.length>22?a.specialization.slice(0,20)+"..":a.specialization;return e.jsx("div",{className:"w-full p-0 m-0 font-['Poppins'] min-h-[600px]",children:e.jsxs("div",{className:"p-8 w-full",children:[e.jsxs("div",{className:"flex items-center bg-white rounded-2xl border border-[#E5E5E5] p-4 mb-8 shadow-sm max-w-md",children:[a.photoUrl?e.jsx("img",{src:a.photoUrl,alt:a.doctorName,className:"w-14 h-14 rounded-xl object-cover bg-[#F8F2F9] mr-4"}):e.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center bg-[#F8F2F9] text-[#8B2D6C] text-xl font-bold mr-4",children:w}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-lg text-black",children:["Dr.",a.doctorName]}),e.jsxs("div",{className:"text-sm text-gray-700",children:["Specialist in ",S]})]})]}),e.jsx("div",{className:"flex flex-col items-center w-full",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-md w-full max-w-2xl flex flex-col items-center mx-auto",children:[e.jsxs("div",{className:"mb-6 w-full flex flex-col items-center",children:[e.jsx("div",{className:"text-lg font-semibold mb-2",children:c.toLocaleString("default",{month:"long",year:"numeric"})}),e.jsx(D,{mode:"single",selected:c,onSelect:t=>{if(t){const l=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()));N(l)}},className:"rounded-xl shadow-sm border",styles:{caption:{color:"#1A2343",fontWeight:600},day_selected:{background:"linear-gradient(90deg, #8B2D6C 0%, #C6426E 100%)",color:"white"},day:{borderRadius:"9999px",fontWeight:500}}})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Slots Available"}),(()=>{const l=n[0].availabilities.find(s=>s.date.split("T")[0]===d);return!l||!l.timeSlots.length?e.jsx("div",{className:"text-gray-500 mb-4",children:"No slots available for this date."}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 mb-8",children:l.timeSlots.map(s=>{const o=s.startTime.slice(11,16);return e.jsx("button",{className:`py-2 rounded-full border w-full ${r===s.id?"bg-gradient-to-r from-[#8B2D6C] to-[#C6426E] text-white border-none":"bg-white text-gray-700 border-gray-300"}`,onClick:()=>j(s.id===r?null:s.id),type:"button",children:o},s.id)})})})(),e.jsx("button",{className:"w-full py-3 rounded-full bg-gradient-to-r from-[#8B2D6C] to-[#C6426E] text-white font-semibold text-lg shadow hover:opacity-90 transition",onClick:v,disabled:x||!r,children:x?"Booking...":"Book Appointment"})]})]})}),e.jsx("div",{className:"w-full mt-8",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow flex flex-col gap-6",children:[e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"All Available Slots"}),h.length===0?e.jsx("p",{className:"text-gray-500",children:"No slots found."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(t=>e.jsxs("div",{className:"border rounded-xl p-4 bg-[#FAF8FB]",children:[e.jsx("div",{className:"font-semibold text-[#8B2D6C] mb-2",children:new Date(t.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:(t.slots||[]).map((l,s)=>e.jsx("span",{className:"inline-block px-3 py-1 rounded-full bg-[#8B2D6C1A] text-[#8B2D6C] text-sm",children:l},s))})]},t.date))})]})})]})})}export{B as default};
