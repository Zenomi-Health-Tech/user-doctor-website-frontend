import{r as l,a as D,j as e,S,b as c,c as i}from"./index-DW9InThs.js";import{S as R,A}from"./sliders-horizontal-DTi2FeyP.js";const P="/assets/mobileTouchRefer-GvEUkM3T.svg",E="data:image/svg+xml,%3csvg%20width='250'%20height='219'%20viewBox='0%200%20250%20219'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='125.271'%20cy='111.697'%20r='124.676'%20fill='black'%20fill-opacity='0.2'/%3e%3ccircle%20cx='125.271'%20cy='111.697'%20r='95.281'%20fill='%238B2D6C'/%3e%3c/svg%3e",L=()=>{const[w,y]=l.useState([]),[j,h]=l.useState(!0),[f,v]=l.useState(""),[x,m]=l.useState(null),[d,u]=l.useState(0),g=5,N=D();l.useEffect(()=>{const t=async()=>{h(!0);try{const r=c.get("auth");let s="";if(r)try{s=JSON.parse(r).token}catch{s=""}const a=await i.get("/doctors/referred-patients",{headers:{Authorization:`Bearer ${s}`}});a.data.success?y(a.data.data):console.error("Failed to fetch referred patients:",a.data)}catch(r){console.error("Error fetching referred patients:",r)}finally{h(!1)}},o=async()=>{try{const r=c.get("auth");let s="";if(r)try{s=JSON.parse(r).token}catch{s=""}const a=await i.get("/doctors/profile",{headers:{Authorization:`Bearer ${s}`}});a.data&&a.data.data&&u(a.data.data.freeReferralsGenerated||0)}catch{u(0)}},n=async()=>{try{const r=c.get("auth");let s="";if(r)try{s=JSON.parse(r).token}catch{s=""}const a=await i.get("/doctors/referral-code",{headers:{Authorization:`Bearer ${s}`}});a.data&&a.data.data&&m(a.data.data.referralCode||a.data.data.code||null)}catch{m(null)}};t(),o(),n()},[]);const C=async()=>{try{const t=c.get("auth");let o="";if(t)try{o=JSON.parse(t).token}catch{o=""}const n=await i.post("/stripe/create-doctor-checkout",{amount:1e3},{headers:{Authorization:`Bearer ${o}`}});n.data&&n.data.url&&(window.location.href=n.data.url)}catch{alert("Failed to generate checkout.")}},k=t=>{N(`/patients/${t}`)},p=w.filter(t=>t.name.toLowerCase().includes(f.toLowerCase())),B=t=>{const o={year:"numeric",month:"short",day:"numeric"};return new Date(t).toLocaleDateString(void 0,o)};return j?e.jsx("div",{className:"flex justify-center items-center h-screen text-xl",children:"Loading referred patients..."}):e.jsxs("div",{className:"p-8 min-h-screen font-['Poppins'] ",children:[e.jsx("h1",{className:"text-3xl font-semibold mb-6 text-gray-800",children:"Referral patients"}),d!==null&&(d>=g?e.jsx("div",{className:"mb-4 p-4 rounded-xl bg-red-100 border border-red-300 text-red-700 text-center font-normal text-lg",children:"You have used all your free referrals. To refer more patients, please upgrade your plan."}):e.jsxs("div",{className:"mb-4 p-4 rounded-xl bg-green-100 border border-green-300 text-green-700 text-center font-semibold text-lg",children:[g-d," free referrals left."]})),e.jsxs("div",{className:"bg-[#8B2D6C] rounded-2xl p-8 flex flex-col md:flex-row items-center justify-between mb-8 relative overflow-hidden",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white text-2xl font-bold mb-2",children:"Get 5 FREE referrals free"}),e.jsx("div",{className:"text-white text-base mb-4",children:"You can onboard up to 5 patients via referral without any charges."}),e.jsx("button",{onClick:C,className:"px-6 py-2 cursor-pointer rounded-full bg-[#FCB35B] text-[#8B2D6C] font-semibold shadow hover:opacity-90 transition",children:"Generate now"})]}),e.jsxs("div",{className:"hidden md:block flex-shrink-0 ml-8 relative",style:{width:120,height:120},children:[e.jsx("img",{src:E,alt:"",className:"w-32 h-54"}),e.jsx("img",{src:P,alt:"Referral Illustration",className:"absolute top-1/2 left-1/2 w-32 h-32 -translate-x-1/2 -translate-y-1/2 object-contain"})]})]}),x&&e.jsxs("div",{className:"bg-gradient-to-r from-[#8B2D6C] to-[#C6426E] rounded-xl px-6 py-4 mb-8 flex items-center justify-between shadow",children:[e.jsx("div",{className:"text-white text-lg font-semibold",children:"Your Referral Code:"}),e.jsx("div",{className:"text-[#FFD700] text-2xl font-bold tracking-widest",children:x})]}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search your patients here",className:"w-full py-3 pl-10 pr-4 rounded-full bg-white border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#8B2D6C]",value:f,onChange:t=>v(t.target.value)})]}),e.jsx("button",{className:"p-3 rounded-full bg-white border border-gray-200 shadow-sm ml-4",children:e.jsx(R,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("div",{className:"space-y-4",children:p.length>0?p.map(t=>e.jsxs("div",{className:"bg-white rounded-2xl px-6 py-4 flex items-center justify-between shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",onClick:()=>k(t.id),style:{cursor:"pointer"},children:[e.jsxs("div",{className:"flex items-center gap-4",children:[t.profilePicture?e.jsx("img",{src:t.profilePicture,alt:t.name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#8B2D6C1A] flex items-center justify-center text-[#8B2D6C] font-semibold text-lg",children:t.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800 text-lg",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Joined on ",B(t.claimedAt)]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("span",{className:"text-[#8B2D6C] font-medium text-base",children:["Referral code - ",t.referralCode]}),e.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-full bg-[#8B2D6C1A] hover:bg-[#8B2D6C]/10 transition",children:e.jsx(A,{className:"w-6 h-6 text-[#8B2D6C]"})})]})]},t.id)):e.jsx("div",{className:"text-center text-gray-500 text-lg mt-10",children:"No referred patients found."})})]})};export{L as default};
